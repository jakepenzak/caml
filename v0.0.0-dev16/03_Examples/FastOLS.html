<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>FastOLS â€“ CaML - Causal ML</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../03_Examples/SyntheticDataGenerator.html" rel="next">
<link href="../03_Examples/AutoCATE.html" rel="prev">
<link href="../assets/logo_no_text.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-9ed85366717b0d4a9233a89d8452de7f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="text/javascript">
    // Enhanced Version Switcher for Quarto Documentation
    // Provides a floating version selector with hover functionality

    (function () {
        "use strict";

        // Configuration
        const CONFIG = {
            containerId: "version-switcher",
            position: { bottom: "20px", right: "20px" },
            versionsJsonPath: getVersionsJsonPath(),
            currentVersionText: getCurrentVersionFromPath(),
        };

        // Utility function to get the correct path to versions.json
        function getVersionsJsonPath() {
            const path = window.location.pathname;
            const segments = path.split("/").filter(Boolean);

            return "/versions.json";
        }

        // Detect current version from URL path
        function getCurrentVersionFromPath() {
            const path = window.location.pathname;
            const versionMatch = path.match(/\/v[\d\.\-\w]+\//);

            if (versionMatch) {
                return versionMatch[0].replace(/\//g, "");
            }
            if (path.includes("dev")) {
                return "dev";
            }

            return "latest";
        }

        // Create version switcher HTML structure
        function createVersionSwitcher(versions) {
            const container = document.createElement("div");
            container.id = CONFIG.containerId;
            container.setAttribute("role", "navigation");
            container.setAttribute("aria-label", "Version selector");

            // Create toggle button
            const toggleButton = document.createElement("button");
            toggleButton.className = "version-toggle-btn";
            toggleButton.setAttribute("aria-haspopup", "true");
            toggleButton.setAttribute("aria-expanded", "false");
            toggleButton.setAttribute(
                "aria-label",
                "Select documentation version",
            );

            const currentVersionLabel = versions.find(
                (v) =>
                    v.text === CONFIG.currentVersionText ||
                    (v.text === "latest" &&
                        CONFIG.currentVersionText === "latest"),
            );

            toggleButton.innerHTML = `
            <span class="version-icon">ðŸ“š</span>
            <span class="version-text">${currentVersionLabel ? currentVersionLabel.text : "Version"}</span>
            <span class="version-arrow">â–¼</span>
        `;

            // Create dropdown menu
            const dropdown = document.createElement("div");
            dropdown.className = "version-dropdown";
            dropdown.setAttribute("role", "menu");
            dropdown.style.display = "none";

            // Create version list
            const versionList = document.createElement("ul");
            versionList.className = "version-list";
            versionList.setAttribute("role", "none");

            versions.forEach((version, index) => {
                const listItem = document.createElement("li");
                listItem.setAttribute("role", "none");

                const link = document.createElement("a");
                link.className = "version-link";
                link.href = version.href;
                link.textContent = version.text;
                link.setAttribute("role", "menuitem");
                link.setAttribute("tabindex", "-1");

                // Mark current version
                if (
                    version.text === CONFIG.currentVersionText ||
                    (version.text === "latest" &&
                        CONFIG.currentVersionText === "latest")
                ) {
                    link.classList.add("current-version");
                    link.setAttribute("aria-current", "page");
                }

                listItem.appendChild(link);
                versionList.appendChild(listItem);
            });

            dropdown.appendChild(versionList);
            container.appendChild(toggleButton);
            container.appendChild(dropdown);

            return { container, toggleButton, dropdown, versionList };
        }

        // Add event listeners for interaction
        function addEventListeners(elements) {
            const { container, toggleButton, dropdown, versionList } = elements;
            let isOpen = false;
            let hoverTimeout;

            // Mouse enter - show dropdown
            container.addEventListener("mouseenter", () => {
                clearTimeout(hoverTimeout);
                showDropdown();
            });

            // Mouse leave - hide dropdown with delay
            container.addEventListener("mouseleave", () => {
                hoverTimeout = setTimeout(() => {
                    hideDropdown();
                }, 300);
            });

            // Click handler for toggle button
            toggleButton.addEventListener("click", (e) => {
                e.preventDefault();
                if (isOpen) {
                    hideDropdown();
                } else {
                    showDropdown();
                }
            });

            // Keyboard navigation
            container.addEventListener("keydown", (e) => {
                const links = versionList.querySelectorAll(".version-link");
                const currentFocus = document.activeElement;
                const currentIndex = Array.from(links).indexOf(currentFocus);

                switch (e.key) {
                    case "Escape":
                        hideDropdown();
                        toggleButton.focus();
                        break;
                    case "ArrowDown":
                        e.preventDefault();
                        if (!isOpen) {
                            showDropdown();
                            links[0]?.focus();
                        } else {
                            const nextIndex =
                                currentIndex < links.length - 1
                                    ? currentIndex + 1
                                    : 0;
                            links[nextIndex]?.focus();
                        }
                        break;
                    case "ArrowUp":
                        e.preventDefault();
                        if (isOpen) {
                            const prevIndex =
                                currentIndex > 0
                                    ? currentIndex - 1
                                    : links.length - 1;
                            links[prevIndex]?.focus();
                        }
                        break;
                    case "Enter":
                    case " ":
                        if (currentFocus === toggleButton) {
                            e.preventDefault();
                            if (isOpen) {
                                hideDropdown();
                            } else {
                                showDropdown();
                                links[0]?.focus();
                            }
                        }
                        break;
                }
            });

            // Click outside to close
            document.addEventListener("click", (e) => {
                if (!container.contains(e.target)) {
                    hideDropdown();
                }
            });

            function showDropdown() {
                dropdown.style.display = "block";
                toggleButton.setAttribute("aria-expanded", "true");
                toggleButton.classList.add("active");
                isOpen = true;

                // Animate in
                requestAnimationFrame(() => {
                    dropdown.style.opacity = "1";
                    dropdown.style.transform = "translateY(0)";
                });
            }

            function hideDropdown() {
                dropdown.style.opacity = "0";
                dropdown.style.transform = "translateY(-10px)";
                toggleButton.setAttribute("aria-expanded", "false");
                toggleButton.classList.remove("active");
                isOpen = false;

                setTimeout(() => {
                    dropdown.style.display = "none";
                }, 200);
            }
        }

        // Apply CSS styles
        function injectStyles() {
            const styleId = "version-switcher-styles";
            if (document.getElementById(styleId)) return;

            const styles = `
            #version-switcher {
                position: fixed;
                bottom: ${CONFIG.position.bottom};
                right: ${CONFIG.position.right};
                z-index: 9999;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                font-size: 14px;
            }

            .version-toggle-btn {
                display: flex;
                align-items: center;
                gap: 8px;
                background: rgba(255, 255, 255, 0.95);
                border: 1px solid rgba(0, 0, 0, 0.1);
                border-radius: 8px;
                padding: 10px 16px;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                backdrop-filter: blur(10px);
                transition: all 0.2s ease;
                color: #333;
                font-weight: 500;
                min-width: 120px;
            }

            .version-toggle-btn:hover {
                background: rgba(255, 255, 255, 1);
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
                transform: translateY(-2px);
                border-color: rgba(0, 109, 9, 0.3);
            }

            .version-toggle-btn.active {
                background: rgba(255, 255, 255, 1);
                border-color: #006d09;
            }

            .version-icon {
                font-size: 16px;
            }

            .version-text {
                flex: 1;
                text-align: left;
            }

            .version-arrow {
                transition: transform 0.2s ease;
                font-size: 12px;
                color: #666;
            }

            .version-toggle-btn.active .version-arrow {
                transform: rotate(180deg);
            }

            .version-dropdown {
                position: absolute;
                bottom: 100%;
                right: 0;
                margin-bottom: 8px;
                background: rgba(255, 255, 255, 0.98);
                border: 1px solid rgba(0, 0, 0, 0.1);
                border-radius: 8px;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
                backdrop-filter: blur(10px);
                opacity: 0;
                transform: translateY(-10px);
                transition: all 0.2s ease;
                min-width: 160px;
            }

            .version-list {
                list-style: none;
                margin: 0;
                padding: 8px 0;
            }

            .version-link {
                display: block;
                padding: 10px 16px;
                color: #333;
                text-decoration: none;
                transition: all 0.15s ease;
                position: relative;
            }

            .version-link:hover,
            .version-link:focus {
                background: rgba(0, 109, 9, 0.1);
                color: #006d09;
                outline: none;
            }

            .version-link.current-version {
                background: rgba(0, 109, 9, 0.1);
                color: #006d09;
                font-weight: 600;
            }

            .version-link.current-version::after {
                content: 'âœ“';
                position: absolute;
                right: 16px;
                top: 50%;
                transform: translateY(-50%);
                font-size: 12px;
            }

            /* Dark mode support */
            @media (prefers-color-scheme: dark) {
                .version-toggle-btn {
                    background: rgba(40, 40, 40, 0.95);
                    border-color: rgba(255, 255, 255, 0.2);
                    color: #e0e0e0;
                }

                .version-toggle-btn:hover {
                    background: rgba(50, 50, 50, 1);
                    border-color: rgba(0, 180, 15, 0.5);
                }

                .version-dropdown {
                    background: rgba(40, 40, 40, 0.98);
                    border-color: rgba(255, 255, 255, 0.2);
                }

                .version-link {
                    color: #e0e0e0;
                }

                .version-link:hover,
                .version-link:focus {
                    background: rgba(0, 180, 15, 0.2);
                    color: #00b80f;
                }

                .version-link.current-version {
                    background: rgba(0, 180, 15, 0.2);
                    color: #00b80f;
                }
            }

            /* Mobile responsive */
            @media (max-width: 768px) {
                #version-switcher {
                    bottom: 15px;
                    right: 15px;
                }

                .version-toggle-btn {
                    padding: 8px 12px;
                    min-width: 100px;
                    font-size: 13px;
                }

                .version-dropdown {
                    min-width: 140px;
                }

                .version-link {
                    padding: 8px 12px;
                    font-size: 13px;
                }
            }
        `;

            const styleElement = document.createElement("style");
            styleElement.id = styleId;
            styleElement.textContent = styles;
            document.head.appendChild(styleElement);
        }

        // Initialize the version switcher
        function init() {
            // Don't initialize if already exists
            if (document.getElementById(CONFIG.containerId)) return;

            fetch(CONFIG.versionsJsonPath)
                .then((response) => {
                    if (!response.ok) {
                        throw new Error(
                            `HTTP error! status: ${response.status}`,
                        );
                    }
                    return response.json();
                })
                .then((versions) => {
                    if (!Array.isArray(versions) || versions.length === 0) {
                        console.warn("No versions found in versions.json");
                        return;
                    }

                    injectStyles();
                    const elements = createVersionSwitcher(versions);
                    addEventListeners(elements);
                    document.body.appendChild(elements.container);
                })
                .catch((error) => {
                    console.warn("Failed to load version switcher:", error);
                });
        }

        // Initialize when DOM is ready
        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", init);
        } else {
            init();
        }
    })();
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles/styles.css">
<meta property="og:title" content="FastOLS â€“ CaML - Causal ML">
<meta property="og:description" content="">
<meta property="og:image" content="FastOLS_files/figure-html/cell-24-output-1.png">
<meta property="og:site_name" content="CaML - Causal ML">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/logo_no_text.svg" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-home" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Home</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-home">    
        <li>
    <a class="dropdown-item" href="../index.html">
 <span class="dropdown-text">Welcome!</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../01_Home/installation.html">
 <span class="dropdown-text">Installation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../01_Home/quickstart.html">
 <span class="dropdown-text">Tutorial: Quick Start</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-concepts" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Concepts</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-concepts">    
        <li>
    <a class="dropdown-item" href="../02_Concepts/motivation.html">
 <span class="dropdown-text">Motivation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../02_Concepts/theory.html">
 <span class="dropdown-text">Econometric Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../02_Concepts/models.html">
 <span class="dropdown-text">Model Specifications</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-examples" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Examples</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-examples">    
        <li>
    <a class="dropdown-item" href="../03_Examples/AutoCATE.html">
 <span class="dropdown-text">AutoCATE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../03_Examples/FastOLS.html">
 <span class="dropdown-text">FastOLS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../03_Examples/SyntheticDataGenerator.html">
 <span class="dropdown-text">Caml Synthetic Data Generator</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-reference" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reference</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-reference">    
        <li>
    <a class="dropdown-item" href="../04_Reference/index.html">
 <span class="dropdown-text">API Reference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../04_Reference/support_matrix.html">
 <span class="dropdown-text">Outcome/Treatment Type Support Matrix</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contributors" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Contributors</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-contributors">    
        <li>
    <a class="dropdown-item" href="../05_Contributors/getting_started.html">
 <span class="dropdown-text">Contributing to CaML</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05_Contributors/environment.html">
 <span class="dropdown-text">Environment Setup</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05_Contributors/documentation.html">
 <span class="dropdown-text">Documentation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05_Contributors/testing.html">
 <span class="dropdown-text">Testing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05_Contributors/conventional_commits.html">
 <span class="dropdown-text">Conventional Commits</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/jakepenzak/caml">
            Source code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/jakepenzak/caml/issues/new">
            Report Issue
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../03_Examples/FastOLS.html">FastOLS</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Examples/AutoCATE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AutoCATE</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Examples/FastOLS.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">FastOLS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Examples/SyntheticDataGenerator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Caml Synthetic Data Generator</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#generate-synthetic-data" id="toc-generate-synthetic-data" class="nav-link active" data-scroll-target="#generate-synthetic-data">Generate Synthetic Data</a></li>
  <li><a href="#running-fastols" id="toc-running-fastols" class="nav-link" data-scroll-target="#running-fastols">Running FastOLS</a>
  <ul class="collapse">
  <li><a href="#class-instantiation" id="toc-class-instantiation" class="nav-link" data-scroll-target="#class-instantiation">Class Instantiation</a></li>
  <li><a href="#fitting-ols-model" id="toc-fitting-ols-model" class="nav-link" data-scroll-target="#fitting-ols-model">Fitting OLS model</a></li>
  <li><a href="#custom-group-average-treatment-effects-gates" id="toc-custom-group-average-treatment-effects-gates" class="nav-link" data-scroll-target="#custom-group-average-treatment-effects-gates">Custom Group Average Treatment Effects (GATEs)</a></li>
  <li><a href="#conditional-average-treatment-effects-cates" id="toc-conditional-average-treatment-effects-cates" class="nav-link" data-scroll-target="#conditional-average-treatment-effects-cates">Conditional Average Treatment Effects (CATEs)</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jakepenzak/caml/edit/main/docs/03_Examples/FastOLS.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jakepenzak/caml/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">FastOLS</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this notebook, weâ€™ll walk through an example of generating synthetic data, estimating treatment effects (ATEs, GATEs, and CATEs) using <code>FastOLS</code>, and comparing to our ground truth.</p>
<p><code>FastOLS</code> is particularly useful when efficiently estimating ATEs and GATEs is of primary interest and the treatment is exogenous or confounding takes on a particularly simple functional form.</p>
<p><code>FastOLS</code> assumes linear treatment effects &amp; heterogeneity. This is generally sufficient for estimation of ATEs and GATEs, but can perform poorly in CATE estimation &amp; prediction when heterogeneity is complex &amp; nonlinear. For high quality CATE estimation, we recommend leveraging <a href="../04_Reference/AutoCATE.html">AutoCATE</a>.</p>
<section id="generate-synthetic-data" class="level2">
<h2 class="anchored" data-anchor-id="generate-synthetic-data">Generate Synthetic Data</h2>
<p>Here weâ€™ll leverage the <a href="../04_Reference/SyntheticDataGenerator.html"><code>SyntheticDataGenerator</code></a> class to generate a linear synthetic data generating process, with an exogenous binary treatment, a continuous &amp; a binary outcome, and binary &amp; continuous mediating covariates.</p>
<div id="6e979ec9" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> caml.generics.logging <span class="im">import</span> configure_logging</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>configure_logging(level<span class="op">=</span>logging.DEBUG)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">[11/10/25 02:30:11] </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Logging configured with level: DEBUG                                     <a href="file:///home/runner/work/caml/caml/caml/generics/logging.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">logging.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/logging.py#75" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">75</span></a>
</pre>
</div>
</div>
<div id="80cc9d25" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> caml.extensions.synthetic_data <span class="im">import</span> SyntheticDataGenerator</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data_generator <span class="op">=</span> SyntheticDataGenerator(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    n_obs<span class="op">=</span><span class="dv">10_000</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    n_cont_outcomes<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    n_binary_outcomes<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    n_binary_treatments<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    n_cont_confounders<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    n_cont_modifiers<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    n_binary_modifiers<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    stddev_outcome_noise<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    stddev_treatment_noise<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    causal_model_functional_form<span class="op">=</span><span class="st">"linear"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">[11/10/25 02:30:12] </span><span style="color: #808000; text-decoration-color: #808000">WARNING </span> SyntheticDataGenerator is experimental and may change in future       <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#57" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">57</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span>         versions.                                                             <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
</pre>
</div>
</div>
<p>We can print our simulated data via:</p>
<div id="213116b4" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_generator.df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">W1_continuous</th>
<th data-quarto-table-cell-role="th">W2_continuous</th>
<th data-quarto-table-cell-role="th">X1_continuous</th>
<th data-quarto-table-cell-role="th">X2_continuous</th>
<th data-quarto-table-cell-role="th">X3_continuous</th>
<th data-quarto-table-cell-role="th">X4_binary</th>
<th data-quarto-table-cell-role="th">X5_binary</th>
<th data-quarto-table-cell-role="th">T1_binary</th>
<th data-quarto-table-cell-role="th">Y1_continuous</th>
<th data-quarto-table-cell-role="th">Y2_binary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.354380</td>
<td>-3.252276</td>
<td>2.715662</td>
<td>-3.578800</td>
<td>-3.148647</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>-11.319410</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.568499</td>
<td>2.484069</td>
<td>-6.402235</td>
<td>-2.611815</td>
<td>-0.311498</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>9.167825</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.162715</td>
<td>8.842902</td>
<td>1.288770</td>
<td>-3.788545</td>
<td>-1.780285</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>-21.010316</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.362944</td>
<td>-0.959538</td>
<td>1.080988</td>
<td>-3.542550</td>
<td>-5.419263</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>-2.194239</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.612101</td>
<td>1.417536</td>
<td>4.143630</td>
<td>-4.112453</td>
<td>-4.551051</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>-20.600668</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9995</td>
<td>0.340436</td>
<td>0.241095</td>
<td>-6.524222</td>
<td>-3.188783</td>
<td>-2.313515</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>16.349832</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9996</td>
<td>0.019523</td>
<td>1.338152</td>
<td>-2.555492</td>
<td>-3.643733</td>
<td>-5.517065</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>5.386195</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9997</td>
<td>0.325401</td>
<td>1.258659</td>
<td>-3.340546</td>
<td>-4.255203</td>
<td>-2.272974</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>-1.037638</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9998</td>
<td>0.586715</td>
<td>1.263264</td>
<td>-2.826709</td>
<td>-4.149383</td>
<td>-2.712932</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>-0.235958</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9999</td>
<td>0.003002</td>
<td>6.723381</td>
<td>1.260782</td>
<td>-3.660600</td>
<td>-0.962271</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>-20.007912</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>10000 rows Ã— 10 columns</p>
</div>
</div>
</div>
<p>To inspect our true data generating process, we can call <code>data_generator.dgp</code>. Furthermore, we will have our true CATEs and ATEs at our disposal via <code>data_generator.cates</code> &amp; <code>data_generator.ates</code>, respectively. Weâ€™ll use this as our source of truth for performance evaluation of our CATE estimator.</p>
<div id="3763ad05" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t, df <span class="kw">in</span> data_generator.dgp.items():</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">DGP for </span><span class="sc">{</span>t<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
DGP for T1_binary:
{'formula': '1 + W1_continuous + W2_continuous', 'params': array([0.00323235, 0.14809798, 0.00393589]), 'noise': array([ 0.41708078,  2.72097405, -0.05882655, ...,  0.53984804,
        1.50464572, -0.08231107]), 'raw_scores': array([0.6130131 , 0.9436502 , 0.50082704, ..., 0.6447923 , 0.83198225,
       0.48696005]), 'function': &lt;function SyntheticDataGenerator._create_dgp_function.&lt;locals&gt;.f_binary at 0x7f359999b1c0&gt;}

DGP for Y1_continuous:
{'formula': '1 + W1_continuous + W2_continuous + X1_continuous + X2_continuous + X3_continuous + X4_binary + X5_binary + T1_binary + T1_binary*X1_continuous + T1_binary*X2_continuous + T1_binary*X3_continuous + T1_binary*X4_binary + T1_binary*X5_binary', 'params': array([-0.35986539, -3.30656481, -1.08522702, -2.03156347,  4.15748518,
       -3.7649075 ,  2.0412171 , -4.06259065,  1.19724956, -1.49108621,
       -0.33216768,  1.0519125 , -0.68252501,  0.57505328]), 'noise': array([ 0.19963494, -0.500903  ,  1.15056187, ..., -1.08977141,
        0.79262583,  1.81566293]), 'raw_scores': array([-11.31940995,   9.16782505, -21.01031565, ...,  -1.03763754,
        -0.23595847, -20.00791171]), 'function': &lt;function SyntheticDataGenerator._create_dgp_function.&lt;locals&gt;.f_cont at 0x7f355d60b910&gt;}

DGP for Y2_binary:
{'formula': '1 + W1_continuous + W2_continuous + X1_continuous + X2_continuous + X3_continuous + X4_binary + X5_binary + T1_binary + T1_binary*X1_continuous + T1_binary*X2_continuous + T1_binary*X3_continuous + T1_binary*X4_binary + T1_binary*X5_binary', 'params': array([-0.69301323,  0.54152509,  0.39837891,  0.15335688,  0.39980853,
       -0.31388112, -0.18490127,  0.25395436,  0.19802621, -0.84703988,
       -0.12066193,  0.09225998,  0.37205785, -0.20954318]), 'noise': array([ 1.07352996,  0.43383419, -1.01413765, ..., -1.15478882,
        0.58572912,  0.22523345]), 'raw_scores': array([0.06237408, 0.99      , 0.75869455, ..., 0.65949716, 0.91015409,
       0.77628529]), 'function': &lt;function SyntheticDataGenerator._create_dgp_function.&lt;locals&gt;.f_binary at 0x7f355d60b9a0&gt;}</code></pre>
</div>
</div>
<div id="9d7fe95a" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_generator.cates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CATE_of_T1_binary_on_Y1_continuous</th>
<th data-quarto-table-cell-role="th">CATE_of_T1_binary_on_Y2_binary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-4.975376</td>
<td>-0.116864</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11.283425</td>
<td>0.779704</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.338690</td>
<td>-0.070368</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-5.620992</td>
<td>-0.088495</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-8.402543</td>
<td>-0.582547</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9995</td>
<td>9.551022</td>
<td>0.857542</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9996</td>
<td>0.989622</td>
<td>0.391185</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9997</td>
<td>5.200762</td>
<td>0.679941</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9998</td>
<td>3.936641</td>
<td>0.602064</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9999</td>
<td>-0.478977</td>
<td>-0.111850</td>
</tr>
</tbody>
</table>

<p>10000 rows Ã— 2 columns</p>
</div>
</div>
</div>
<div id="81d1d6ea" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_generator.ates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Treatment</th>
<th data-quarto-table-cell-role="th">ATE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>T1_binary_on_Y1_continuous</td>
<td>1.195965</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>T1_binary_on_Y2_binary</td>
<td>0.152762</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="running-fastols" class="level2">
<h2 class="anchored" data-anchor-id="running-fastols">Running FastOLS</h2>
<section id="class-instantiation" class="level3">
<h3 class="anchored" data-anchor-id="class-instantiation">Class Instantiation</h3>
<p>We can instantiate and observe our <code>FastOLS</code> object via:</p>
<div id="186285eb" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> caml <span class="im">import</span> FastOLS</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>fo_obj <span class="op">=</span> FastOLS(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    Y<span class="op">=</span>[c <span class="cf">for</span> c <span class="kw">in</span> data_generator.df.columns <span class="cf">if</span> <span class="st">"Y"</span> <span class="kw">in</span> c],</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    T<span class="op">=</span><span class="st">"T1_binary"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    G<span class="op">=</span>[</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        c</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c <span class="kw">in</span> data_generator.df.columns</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"X"</span> <span class="kw">in</span> c <span class="kw">and</span> (<span class="st">"bin"</span> <span class="kw">in</span> c <span class="kw">or</span> <span class="st">"dis"</span> <span class="kw">in</span> c)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    X<span class="op">=</span>[c <span class="cf">for</span> c <span class="kw">in</span> data_generator.df.columns <span class="cf">if</span> <span class="st">"X"</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">"cont"</span> <span class="kw">in</span> c],</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    W<span class="op">=</span>[c <span class="cf">for</span> c <span class="kw">in</span> data_generator.df.columns <span class="cf">if</span> <span class="st">"W"</span> <span class="kw">in</span> c],</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    xformula<span class="op">=</span><span class="st">"+ W1_continuous**2"</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    engine<span class="op">=</span><span class="st">"cpu"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    discrete_treatment<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Initializing FastOLS with parameters: <span style="color: #808000; text-decoration-color: #808000">Y</span>=<span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'Y1_continuous'</span>, <span style="color: #008000; text-decoration-color: #008000">'Y2_binary'</span><span style="font-weight: bold">]</span>,     <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#140" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">140</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span>         <span style="color: #808000; text-decoration-color: #808000">T</span>=<span style="color: #800080; text-decoration-color: #800080">T1_binary</span>, <span style="color: #808000; text-decoration-color: #808000">G</span>=<span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'X4_binary'</span>, <span style="color: #008000; text-decoration-color: #008000">'X5_binary'</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">X</span>=<span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'X1_continuous'</span>,              <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span>         <span style="color: #008000; text-decoration-color: #008000">'X2_continuous'</span>, <span style="color: #008000; text-decoration-color: #008000">'X3_continuous'</span><span style="font-weight: bold">]</span>, <span style="color: #808000; text-decoration-color: #808000">W</span>=<span style="font-weight: bold">[</span><span style="color: #008000; text-decoration-color: #008000">'W1_continuous'</span>, <span style="color: #008000; text-decoration-color: #008000">'W2_continuous'</span><span style="font-weight: bold">]</span>,    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span>         <span style="color: #808000; text-decoration-color: #808000">discrete_treatment</span>=<span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>, <span style="color: #808000; text-decoration-color: #808000">engine</span>=<span style="color: #800080; text-decoration-color: #800080">cpu</span>                                         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Created formula: <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'Y1_continuous'</span><span style="font-weight: bold">)</span> + <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'Y2_binary'</span><span style="font-weight: bold">)</span> ~ <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">C</span><span style="font-weight: bold">(</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'T1_binary'</span><span style="font-weight: bold">))</span> +  <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#174" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">174</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span>         <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">C</span><span style="font-weight: bold">(</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'X4_binary'</span><span style="font-weight: bold">))</span>*<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">C</span><span style="font-weight: bold">(</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'T1_binary'</span><span style="font-weight: bold">))</span> + <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">C</span><span style="font-weight: bold">(</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'X5_binary'</span><span style="font-weight: bold">))</span>*<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">C</span><span style="font-weight: bold">(</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'T1_binary'</span><span style="font-weight: bold">))</span> + <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span>         <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'X1_continuous'</span><span style="font-weight: bold">)</span>*<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">C</span><span style="font-weight: bold">(</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'T1_binary'</span><span style="font-weight: bold">))</span> + <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'X2_continuous'</span><span style="font-weight: bold">)</span>*<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">C</span><span style="font-weight: bold">(</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'T1_binary'</span><span style="font-weight: bold">))</span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span>         + <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'X3_continuous'</span><span style="font-weight: bold">)</span>*<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">C</span><span style="font-weight: bold">(</span><span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'T1_binary'</span><span style="font-weight: bold">))</span> + <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'W1_continuous'</span><span style="font-weight: bold">)</span> +               <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span>         <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">Q</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">'W2_continuous'</span><span style="font-weight: bold">)</span> + W1_continuous**<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>                                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">          </span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #808000; text-decoration-color: #808000">WARNING </span> FastOLS is experimental and may change in future versions.            <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#57" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">57</span></a>
</pre>
</div>
</div>
<div id="5a7c0559" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fo_obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>================== FastOLS Object ==================
Engine: cpu
Outcome Variable: ['Y1_continuous', 'Y2_binary']
Treatment Variable: T1_binary
Discrete Treatment: True
Group Variables: ['X4_binary', 'X5_binary']
Features/Confounders for Heterogeneity (X): ['X1_continuous', 'X2_continuous', 'X3_continuous']
Features/Confounders as Controls (W): ['W1_continuous', 'W2_continuous']
Formula: Q('Y1_continuous') + Q('Y2_binary') ~ C(Q('T1_binary')) + C(Q('X4_binary'))*C(Q('T1_binary')) + C(Q('X5_binary'))*C(Q('T1_binary')) + Q('X1_continuous')*C(Q('T1_binary')) + Q('X2_continuous')*C(Q('T1_binary')) + Q('X3_continuous')*C(Q('T1_binary')) + Q('W1_continuous') + Q('W2_continuous') + W1_continuous**2
</code></pre>
</div>
</div>
</section>
<section id="fitting-ols-model" class="level3">
<h3 class="anchored" data-anchor-id="fitting-ols-model">Fitting OLS model</h3>
<p>We can now leverage the <code>fit</code> method to estimate the model outlined by <code>fo_obj.formula</code>. To capitalize on efficiency gains and parallelization in the estimation of GATEs, we will pass <code>estimate_effects=True</code>. The <code>n_jobs</code> argument will control the number of parallel jobs (GATE estimations) executed at a time. We will set <code>n_jobs=-1</code> to use all available cores for parallelization.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>When dealing with large datasets, setting <code>n_jobs</code> to a more conservative value can help prevent OOM errors.</p>
</div>
</div>
<p>For heteroskedasticity-robust variance estimation, we will also pass <code>robust_vcv=True</code>.</p>
<div id="e73ecd34" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fo_obj.fit(data_generator.df, n_jobs<span class="op">=-</span><span class="dv">1</span>, estimate_effects<span class="op">=</span><span class="va">True</span>, cov_type<span class="op">=</span><span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Creating model design matrix<span style="color: #808000; text-decoration-color: #808000">...</span>                                             <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#545" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">545</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Design Matrix Creation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.06</span> seconds                     <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008000; text-decoration-color: #008000">INFO    </span> Fitting regression model<span style="color: #808000; text-decoration-color: #808000">...</span>                                                 <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#508" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">508</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Model Fitting completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span> seconds                              <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Creating treatment difference matrix<span style="color: #808000; text-decoration-color: #808000">...</span>                                     <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#571" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">571</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Difference Matrix Creation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.11</span> seconds                 <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008000; text-decoration-color: #008000">INFO    </span> Estimating Average Treatment Effects <span style="font-weight: bold">(</span>ATEs<span style="font-weight: bold">)</span><span style="color: #808000; text-decoration-color: #808000">...</span>                              <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#293" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">293</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> ATE Estimation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.00</span> seconds                             <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008000; text-decoration-color: #008000">INFO    </span> Estimating Group Average Treatment Effects <span style="font-weight: bold">(</span>GATEs<span style="font-weight: bold">)</span><span style="color: #808000; text-decoration-color: #808000">...</span>                       <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#667" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">667</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Starting parallel processing with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">-1</span> jobs                                   <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#695" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">695</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Prespecified GATE Estimation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span> seconds               <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
</div>
<p>We can now inspect the model fitted results and estimated treatment effects:</p>
<div id="be05c66f" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fo_obj.params</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fo_obj.vcv</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fo_obj.std_err</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fo_obj.fitted_values</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fo_obj.residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>array([[-0.4519221 ,  0.43114593],
       [ 1.38073585, -0.0744549 ],
       [ 2.00450453, -0.01259566],
       [-4.04210602,  0.02437893],
       [-0.65283268,  0.04810221],
       [ 0.49183752, -0.01360602],
       [-2.02552124,  0.02571064],
       [-1.49027655, -0.10135024],
       [ 4.14289136,  0.06712511],
       [-0.28916188, -0.05434839],
       [-3.76790351, -0.05556488],
       [ 1.05912299,  0.03298887],
       [-1.63464173,  0.03581225],
       [-1.07407314,  0.04467536],
       [-1.63464173,  0.03581225]])</code></pre>
</div>
</div>
<div id="ecbd7797" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fo_obj.treatment_effects.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>dict_keys(['overall', 'X4_binary-0', 'X4_binary-1', 'X5_binary-0', 'X5_binary-1'])</code></pre>
</div>
</div>
<div id="abcd148d" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fo_obj.treatment_effects[<span class="st">"overall"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>{'outcome': ['Y1_continuous', 'Y2_binary'],
 'ate': array([[1.19490455, 0.13807782]]),
 'std_err': array([[0.01986595, 0.00783239]]),
 't_stat': array([[60.14836561, 17.62907058]]),
 'pval': array([[0., 0.]]),
 'n': 10000,
 'n_treated': 5172,
 'n_control': 4828}</code></pre>
</div>
</div>
<p>Here we have direct access to the model parameters (<code>fo_obj.params</code>), variance-covariance matrices (<code>fo_obj.vcv]</code>), standard_errors (<code>fo_obj.std_err</code>), and estimated treatment effects (<code>fo_obj.treatment_effects</code>).</p>
<p>To make the treatment effect results more readable, we can leverage the <code>prettify_treatment_effects</code> method:</p>
<div id="eba40416" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fo_obj.prettify_treatment_effects()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">membership</th>
<th data-quarto-table-cell-role="th">outcome</th>
<th data-quarto-table-cell-role="th">ate</th>
<th data-quarto-table-cell-role="th">std_err</th>
<th data-quarto-table-cell-role="th">t_stat</th>
<th data-quarto-table-cell-role="th">pval</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">n_treated</th>
<th data-quarto-table-cell-role="th">n_control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>overall</td>
<td>None</td>
<td>Y1_continuous</td>
<td>1.194905</td>
<td>0.019866</td>
<td>60.148366</td>
<td>0.000000e+00</td>
<td>10000</td>
<td>5172</td>
<td>4828</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>overall</td>
<td>None</td>
<td>Y2_binary</td>
<td>0.138078</td>
<td>0.007832</td>
<td>17.629071</td>
<td>0.000000e+00</td>
<td>10000</td>
<td>5172</td>
<td>4828</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>X4_binary</td>
<td>0</td>
<td>Y1_continuous</td>
<td>1.336099</td>
<td>0.021504</td>
<td>62.133499</td>
<td>0.000000e+00</td>
<td>8536</td>
<td>4374</td>
<td>4162</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>X4_binary</td>
<td>0</td>
<td>Y2_binary</td>
<td>0.134263</td>
<td>0.008443</td>
<td>15.902456</td>
<td>0.000000e+00</td>
<td>8536</td>
<td>4374</td>
<td>4162</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>X4_binary</td>
<td>1</td>
<td>Y1_continuous</td>
<td>0.371658</td>
<td>0.051932</td>
<td>7.156565</td>
<td>8.273382e-13</td>
<td>1464</td>
<td>798</td>
<td>666</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>X4_binary</td>
<td>1</td>
<td>Y2_binary</td>
<td>0.160322</td>
<td>0.021007</td>
<td>7.631865</td>
<td>2.309264e-14</td>
<td>1464</td>
<td>798</td>
<td>666</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>X5_binary</td>
<td>0</td>
<td>Y1_continuous</td>
<td>1.149854</td>
<td>0.021556</td>
<td>53.342794</td>
<td>0.000000e+00</td>
<td>8564</td>
<td>4430</td>
<td>4134</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>X5_binary</td>
<td>0</td>
<td>Y2_binary</td>
<td>0.142165</td>
<td>0.008438</td>
<td>16.848194</td>
<td>0.000000e+00</td>
<td>8564</td>
<td>4430</td>
<td>4134</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>X5_binary</td>
<td>1</td>
<td>Y1_continuous</td>
<td>1.463574</td>
<td>0.051157</td>
<td>28.609334</td>
<td>0.000000e+00</td>
<td>1436</td>
<td>742</td>
<td>694</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>X5_binary</td>
<td>1</td>
<td>Y2_binary</td>
<td>0.113703</td>
<td>0.020950</td>
<td>5.427234</td>
<td>5.723416e-08</td>
<td>1436</td>
<td>742</td>
<td>694</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Comparing our overall treatment effect (ATE) to the ground truth, we have:</p>
<div id="982a4989" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_generator.ates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Treatment</th>
<th data-quarto-table-cell-role="th">ATE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>T1_binary_on_Y1_continuous</td>
<td>1.195965</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>T1_binary_on_Y2_binary</td>
<td>0.152762</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We can also see what our GATEs are using <code>data_generator.cates</code>. Letâ€™s choose <code>X4_binary</code> in <code>1</code> group:</p>
<div id="956ac57b" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data_generator.cates.iloc[</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    data_generator.df.query(<span class="st">"X4_binary == 1"</span>).index</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>CATE_of_T1_binary_on_Y1_continuous    0.347413
CATE_of_T1_binary_on_Y2_binary        0.177773
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="custom-group-average-treatment-effects-gates" class="level3">
<h3 class="anchored" data-anchor-id="custom-group-average-treatment-effects-gates">Custom Group Average Treatment Effects (GATEs)</h3>
<p>Letâ€™s now look at how we can estimate any arbitary GATE using <code>estimate_ate</code> method and prettify the results with <code>prettify_treatment_effects</code>.</p>
<div id="040ba30f" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>custom_gate_df <span class="op">=</span> data_generator.df.query(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X4_binary == 1 &amp; X2_continuous &lt; -3"</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>).copy()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>custom_gate <span class="op">=</span> fo_obj.estimate_ate(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    custom_gate_df,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    group<span class="op">=</span><span class="st">"My Custom Group"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    membership<span class="op">=</span><span class="st">"My Custom Membership"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    return_results_dict<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>fo_obj.prettify_treatment_effects(effects<span class="op">=</span>custom_gate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008000; text-decoration-color: #008000">INFO    </span> Estimating Average Treatment Effects <span style="font-weight: bold">(</span>ATEs<span style="font-weight: bold">)</span><span style="color: #808000; text-decoration-color: #808000">...</span>                              <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#293" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">293</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Creating treatment difference matrix<span style="color: #808000; text-decoration-color: #808000">...</span>                                     <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#571" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">571</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Difference Matrix Creation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.02</span> seconds                 <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> ATE Estimation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.03</span> seconds                             <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">membership</th>
<th data-quarto-table-cell-role="th">outcome</th>
<th data-quarto-table-cell-role="th">ate</th>
<th data-quarto-table-cell-role="th">std_err</th>
<th data-quarto-table-cell-role="th">t_stat</th>
<th data-quarto-table-cell-role="th">pval</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">n_treated</th>
<th data-quarto-table-cell-role="th">n_control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>My Custom Group</td>
<td>My Custom Membership</td>
<td>Y1_continuous</td>
<td>0.541877</td>
<td>0.052269</td>
<td>10.367002</td>
<td>0.0</td>
<td>1197</td>
<td>661</td>
<td>536</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>My Custom Group</td>
<td>My Custom Membership</td>
<td>Y2_binary</td>
<td>0.184703</td>
<td>0.021119</td>
<td>8.746004</td>
<td>0.0</td>
<td>1197</td>
<td>661</td>
<td>536</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Letâ€™s compare this to the ground truth as well:</p>
<div id="661f360a" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data_generator.cates.iloc[custom_gate_df.index].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>CATE_of_T1_binary_on_Y1_continuous    0.530934
CATE_of_T1_binary_on_Y2_binary        0.198813
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="conditional-average-treatment-effects-cates" class="level3">
<h3 class="anchored" data-anchor-id="conditional-average-treatment-effects-cates">Conditional Average Treatment Effects (CATEs)</h3>
<p>Letâ€™s now look at how we can estimate CATEs / approximate individual-level treatment effects via <code>estimate_cate</code> method</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>predict</code> method is a simple alias for <code>estimate_cate</code>. Either can be used, but namespacing was created to higlight that <code>estimate_cate</code> / <code>predict</code> can be used for out of sample treatment effect prediction.</p>
</div>
</div>
<div id="c550780c" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>cates <span class="op">=</span> fo_obj.estimate_cate(data_generator.df)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>cates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008000; text-decoration-color: #008000">INFO    </span> Estimating Conditional Average Treatment Effects <span style="font-weight: bold">(</span>CATEs<span style="font-weight: bold">)</span><span style="color: #808000; text-decoration-color: #808000">...</span>                 <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#361" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">361</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Creating treatment difference matrix<span style="color: #808000; text-decoration-color: #808000">...</span>                                     <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#571" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">571</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Difference Matrix Creation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span> seconds                 <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> CATE Estimation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span> seconds                            <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>array([[-4.96630384, -0.25905625],
       [11.3471586 ,  0.70608504],
       [-1.32992654, -0.05790035],
       ...,
       [ 5.18215613,  0.42039076],
       [ 3.91982932,  0.34804847],
       [-0.45883511, -0.03503195]])</code></pre>
</div>
</div>
<p>If we wanted additional information on CATEs (such as standard errors), we can call:</p>
<div id="ecf86d03" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fo_obj.estimate_cate(data_generator.df, return_results_dict<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008000; text-decoration-color: #008000">INFO    </span> Estimating Conditional Average Treatment Effects <span style="font-weight: bold">(</span>CATEs<span style="font-weight: bold">)</span><span style="color: #808000; text-decoration-color: #808000">...</span>                 <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#361" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">361</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Creating treatment difference matrix<span style="color: #808000; text-decoration-color: #808000">...</span>                                     <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#571" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">571</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Difference Matrix Creation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span> seconds                 <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> CATE Estimation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.09</span> seconds                            <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>{'outcome': ['Y1_continuous', 'Y2_binary'],
 'cate': array([[-4.96630384, -0.25905625],
        [11.3471586 ,  0.70608504],
        [-1.32992654, -0.05790035],
        ...,
        [ 5.18215613,  0.42039076],
        [ 3.91982932,  0.34804847],
        [-0.45883511, -0.03503195]]),
 'std_err': array([[0.02874559, 0.01134792],
        [0.04431468, 0.01669346],
        [0.02526043, 0.00995281],
        ...,
        [0.02767557, 0.01025595],
        [0.02636869, 0.00997712],
        [0.02779769, 0.01090012]]),
 't_stat': array([[-172.76749964,  -22.82852289],
        [ 256.05869601,   42.29711604],
        [ -52.6486181 ,   -5.8174884 ],
        ...,
        [ 187.2465665 ,   40.98993518],
        [ 148.6546921 ,   34.88465475],
        [ -16.50623202,   -3.21390529]]),
 'pval': array([[0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 5.97384053e-09],
        ...,
        [0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 1.30942855e-03]])}</code></pre>
</div>
</div>
<p>Now, letâ€™s make our cate predictions:</p>
<div id="76e74732" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cate_predictions <span class="op">=</span> fo_obj.predict(data_generator.df)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">## We can also make predictions of the outcomes, if desired.</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fo_obj.predict(data_generator.df, mode="outcome")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008000; text-decoration-color: #008000">INFO    </span> Estimating Conditional Average Treatment Effects <span style="font-weight: bold">(</span>CATEs<span style="font-weight: bold">)</span><span style="color: #808000; text-decoration-color: #808000">...</span>                 <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#361" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">361</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Creating treatment difference matrix<span style="color: #808000; text-decoration-color: #808000">...</span>                                     <a href="file:///home/runner/work/caml/caml/caml/core/ols.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">ols.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/core/ols.py#571" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">571</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> Difference Matrix Creation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span> seconds                 <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">                    </span><span style="color: #008080; text-decoration-color: #008080">DEBUG   </span> CATE Estimation completed in <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.08</span> seconds                            <a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">decorators.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/runner/work/caml/caml/caml/generics/decorators.py#146" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">146</span></a>
</pre>
</div>
</div>
<p>Letâ€™s now look at the Precision in Estimating Heterogeneous Effects (PEHE) (e.g., RMSE) and plot some results for the treatment effects on each outcome:</p>
<section id="effect-of-binary-t1-on-continuous-y1" class="level4">
<h4 class="anchored" data-anchor-id="effect-of-binary-t1-on-continuous-y1">Effect of <em>binary</em> T1 on <em>continuous</em> Y1</h4>
<div id="9969c198" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> root_mean_squared_error</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> caml.extensions.plots <span class="im">import</span> (</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    cate_true_vs_estimated_plot,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    cate_histogram_plot,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    cate_line_plot,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b9208fba" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>true_cates1 <span class="op">=</span> data_generator.cates.iloc[:, <span class="dv">0</span>]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>predicted_cates1 <span class="op">=</span> cate_predictions[:, <span class="dv">0</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>root_mean_squared_error(true_cates1, predicted_cates1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0.05419754264094474</code></pre>
</div>
</div>
<div id="3f7d48a6" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cate_true_vs_estimated_plot(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    true_cates<span class="op">=</span>true_cates1, estimated_cates<span class="op">=</span>predicted_cates1</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<figure class="figure">
<p><img src="FastOLS_files/figure-html/cell-24-output-1.png" width="601" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="385a670c" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cate_histogram_plot(true_cates<span class="op">=</span>true_cates1, estimated_cates<span class="op">=</span>predicted_cates1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>
<figure class="figure">
<p><img src="FastOLS_files/figure-html/cell-25-output-1.png" width="575" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a074daa9" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>cate_line_plot(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    true_cates<span class="op">=</span>true_cates1, estimated_cates<span class="op">=</span>predicted_cates1, window<span class="op">=</span><span class="dv">20</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<figure class="figure">
<p><img src="FastOLS_files/figure-html/cell-26-output-1.png" width="601" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="effect-of-binary-t1-on-binary-y2" class="level4">
<h4 class="anchored" data-anchor-id="effect-of-binary-t1-on-binary-y2">Effect of <em>binary</em> T1 on <em>binary</em> Y2</h4>
<div id="b692add0" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>true_cates2 <span class="op">=</span> data_generator.cates.iloc[:, <span class="dv">1</span>]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>predicted_cates2 <span class="op">=</span> cate_predictions[:, <span class="dv">1</span>]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>root_mean_squared_error(true_cates2, predicted_cates2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>0.15683038625127846</code></pre>
</div>
</div>
<div id="11829bee" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cate_true_vs_estimated_plot(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    true_cates<span class="op">=</span>true_cates2, estimated_cates<span class="op">=</span>predicted_cates2</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>
<figure class="figure">
<p><img src="FastOLS_files/figure-html/cell-28-output-1.png" width="605" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3e58ba84" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>cate_histogram_plot(true_cates<span class="op">=</span>true_cates2, estimated_cates<span class="op">=</span>predicted_cates2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>
<figure class="figure">
<p><img src="FastOLS_files/figure-html/cell-29-output-1.png" width="575" height="440" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="22c144e3" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>cate_line_plot(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    true_cates<span class="op">=</span>true_cates2, estimated_cates<span class="op">=</span>predicted_cates2, window<span class="op">=</span><span class="dv">20</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>
<figure class="figure">
<p><img src="FastOLS_files/figure-html/cell-30-output-1.png" width="614" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The CATE estimates for binary outcome using simulated data may perform poorly b/c of non-linear transformation (sigmoid) of linear logodds. In general, <code>FastOLS</code> should be prioritized when ATEs and GATEs are of primary interest. For high quality CATE estimation, we recommend leveraging <a href="../04_Reference/AutoCATE.html">AutoCATE</a>.</p>
</div>
</div>


</section>
</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../03_Examples/AutoCATE.html" class="pagination-link" aria-label="AutoCATE">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">AutoCATE</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../03_Examples/SyntheticDataGenerator.html" class="pagination-link" aria-label="Caml Synthetic Data Generator">
        <span class="nav-page-text">Caml Synthetic Data Generator</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Â© Copyright 2024, Jacob Pieniazek</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jakepenzak/caml/edit/main/docs/03_Examples/FastOLS.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jakepenzak/caml/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Powered by: <a href="https://quarto.org/"><img src="../assets/external_logos/quarto.png" class="img-fluid" width="85"></a></p>
</div>
  </div>
</footer>




</body></html>