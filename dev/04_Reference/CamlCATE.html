<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>camlcate – CaML - Causal ML</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../assets/logo_no_text.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f3013b28522636034a8b0c5edeebf926.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles/styles.css">
<meta property="og:title" content="CaML - Causal ML">
<meta property="og:description" content="">
<meta property="og:image" content="CamlCATE_files/figure-html/cell-5-output-2.png">
<meta property="og:site_name" content="CaML - Causal ML">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/logo_no_text.svg" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-home" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Home</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-home">    
        <li>
    <a class="dropdown-item" href="../index.html">
 <span class="dropdown-text">Welcome!</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../01_Home/installation.html">
 <span class="dropdown-text">Installation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../01_Home/quickstart.html">
 <span class="dropdown-text">Tutorial: Quick Start</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-concepts" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Concepts</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-concepts">    
        <li>
    <a class="dropdown-item" href="../02_Concepts/motivation.html">
 <span class="dropdown-text">Motivation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../02_Concepts/theory.html">
 <span class="dropdown-text">Econometric Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../02_Concepts/models.html">
 <span class="dropdown-text">Model Specifications</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-examples" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Examples</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-examples">    
        <li>
    <a class="dropdown-item" href="../03_Examples/CamlCATE.html">
 <span class="dropdown-text">CamlCATE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../03_Examples/FastOLS.html">
 <span class="dropdown-text">FastOLS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../03_Examples/SyntheticDataGenerator.html">
 <span class="dropdown-text">Caml Synthetic Data Generator</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-reference" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Reference</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-reference">    
        <li>
    <a class="dropdown-item" href="../04_Reference/index.html">
 <span class="dropdown-text">API Reference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../04_Reference/support_matrix.html">
 <span class="dropdown-text">Outcome/Treatment Type Support Matrix</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contributors" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Contributors</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-contributors">    
        <li>
    <a class="dropdown-item" href="../05_Contributors/getting_started.html">
 <span class="dropdown-text">Contributing to CaML</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05_Contributors/environment.html">
 <span class="dropdown-text">Environment Setup</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05_Contributors/documentation.html">
 <span class="dropdown-text">Documentation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05_Contributors/testing.html">
 <span class="dropdown-text">Testing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../05_Contributors/conventional_commits.html">
 <span class="dropdown-text">Conventional Commits</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/jakepenzak/caml">
            Source code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/jakepenzak/caml/issues/new">
            Report Issue
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#parameters" id="toc-parameters" class="nav-link active" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#attributes" id="toc-attributes" class="nav-link" data-scroll-target="#attributes">Attributes</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#caml.CamlCATE.auto_nuisance_functions" id="toc-caml.CamlCATE.auto_nuisance_functions" class="nav-link" data-scroll-target="#caml.CamlCATE.auto_nuisance_functions">auto_nuisance_functions</a></li>
  <li><a href="#caml.CamlCATE.fit_validator" id="toc-caml.CamlCATE.fit_validator" class="nav-link" data-scroll-target="#caml.CamlCATE.fit_validator">fit_validator</a></li>
  <li><a href="#caml.CamlCATE.validate" id="toc-caml.CamlCATE.validate" class="nav-link" data-scroll-target="#caml.CamlCATE.validate">validate</a></li>
  <li><a href="#caml.CamlCATE.fit_final" id="toc-caml.CamlCATE.fit_final" class="nav-link" data-scroll-target="#caml.CamlCATE.fit_final">fit_final</a></li>
  <li><a href="#caml.CamlCATE.predict" id="toc-caml.CamlCATE.predict" class="nav-link" data-scroll-target="#caml.CamlCATE.predict">predict</a></li>
  <li><a href="#caml.CamlCATE.summarize" id="toc-caml.CamlCATE.summarize" class="nav-link" data-scroll-target="#caml.CamlCATE.summarize">summarize</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jakepenzak/caml/edit/main/docs/04_Reference/CamlCATE.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jakepenzak/caml/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">CamlCATE</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>CamlCATE(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    Y,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    T,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    W<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    discrete_treatment<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    discrete_outcome<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The CamlCATE class represents an opinionated framework of Causal Machine Learning techniques for estimating highly accurate conditional average treatment effects (CATEs).</p>
<p><strong>CamlCATE is experimental and may change significantly in future versions.</strong></p>
<p>The CATE is defined formally as <span class="math inline">\(\mathbb{E}[\tau|\mathbf{X}]\)</span> where <span class="math inline">\(\tau\)</span> is the treatment effect and <span class="math inline">\(\mathbf{X}\)</span> is the set of covariates.</p>
<p>This class is built on top of the EconML library and provides a high-level API for fitting, validating, and making inference with CATE models, with best practices built directly into the API. The class is designed to be easy to use and understand, while still providing flexibility for advanced users. The class is designed to be used with <code>pandas</code>, <code>polars</code>, or <code>pyspark</code> backends, which ultimately get converted to NumPy Arrays under the hood to provide a level of extensibility &amp; interoperability across different data processing frameworks.</p>
<p>The primary workflow for the CamlCATE class is as follows:</p>
<ol type="1">
<li>Initialize the class with the input DataFrame and the necessary columns.</li>
<li>Utilize <a href="https://microsoft.github.io/FLAML/">flaml</a> AutoML to find nuisance functions or propensity/regression models to be utilized in the EconML estimators.</li>
<li>Fit the CATE models on the training set and select top performer based on the RScore from validation set.</li>
<li>Validate the fitted CATE model on the test set to check for generalization performance.</li>
<li>Fit the final estimator on the entire dataset, after validation and testing.</li>
<li>Predict the CATE based on the fitted final estimator for either the internal dataset or an out-of-sample dataset.</li>
<li>Summarize population summary statistics for the CATE predictions for either the internal dataset or out-of-sample predictions.</li>
</ol>
<p>For technical details on conditional average treatment effects, see:</p>
<ul>
<li>CaML Documentation</li>
<li><a href="https://econml.azurewebsites.net/">EconML documentation</a></li>
</ul>
<p><strong>Note</strong>: All the standard assumptions of Causal Inference apply to this class (e.g., exogeneity/unconfoundedness, overlap, positivity, etc.). The class does not check for these assumptions and assumes that the user has already thought through these assumptions before using the class.</p>
<p>For outcome/treatment support, see <a href="../04_Reference/support_matrix.html">matrix</a>.</p>
<p>For a more detailed working example, see <a href="../03_Examples/CamlCATE.html">CamlCATE Example</a>.</p>
<section id="parameters" class="level2 doc-section doc-section-parameters">
<h2 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters">Parameters</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 20%">
<col style="width: 68%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>df</td>
<td>pandas.DataFrame | polars.DataFrame | pyspark.sql.DataFrame</td>
<td>The input DataFrame representing the data for the CamlCATE instance.</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>Y</td>
<td>str</td>
<td>The str representing the column name for the outcome variable.</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>T</td>
<td>str</td>
<td>The str representing the column name(s) for the treatment variable(s).</td>
<td><em>required</em></td>
</tr>
<tr class="even">
<td>X</td>
<td>str | list[str]</td>
<td>The str (if unity) or list of feature names representing the feature set to be utilized for estimating heterogeneity/CATE.</td>
<td><em>required</em></td>
</tr>
<tr class="odd">
<td>W</td>
<td>str | list[str] | None</td>
<td>The str (if unity) or list of feature names representing the confounder/control feature set to be utilized only for nuisance function estimation. When W is passed, only Orthogonal learners will be leveraged.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>discrete_treatment</td>
<td>bool</td>
<td>A boolean indicating whether the treatment is discrete/categorical or continuous.</td>
<td><code>True</code></td>
</tr>
<tr class="odd">
<td>discrete_outcome</td>
<td>bool</td>
<td>A boolean indicating whether the outcome is binary or continuous.</td>
<td><code>False</code></td>
</tr>
<tr class="even">
<td>seed</td>
<td>int | None</td>
<td>The seed to use for the random number generator.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="attributes" class="level2 doc-section doc-section-attributes">
<h2 class="doc-section doc-section-attributes anchored" data-anchor-id="attributes">Attributes</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 27%">
<col style="width: 65%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>df</td>
<td>pandas.DataFrame | polars.DataFrame | pyspark.sql.DataFrame</td>
<td>The input DataFrame representing the data for the CamlCATE instance.</td>
</tr>
<tr class="even">
<td>Y</td>
<td>str</td>
<td>The str representing the column name for the outcome variable.</td>
</tr>
<tr class="odd">
<td>T</td>
<td>str</td>
<td>The str representing the column name(s) for the treatment variable(s).</td>
</tr>
<tr class="even">
<td>X</td>
<td>Iterable[str]</td>
<td>The str (if unity) or list of variable names representing the confounder/control feature set to be utilized for estimating heterogeneity/CATE and nuisance function estimation where applicable.</td>
</tr>
<tr class="odd">
<td>W</td>
<td>Iterable[str] | None</td>
<td>The str (if unity) or list of variable names representing the confounder/control feature set to be utilized only for nuisance function estimation, where applicable. These will be included by default in Meta-Learners.</td>
</tr>
<tr class="even">
<td>discrete_treatment</td>
<td>bool</td>
<td>A boolean indicating whether the treatment is discrete/categorical or continuous.</td>
</tr>
<tr class="odd">
<td>discrete_outcome</td>
<td>bool</td>
<td>A boolean indicating whether the outcome is binary or continuous.</td>
</tr>
<tr class="even">
<td>available_estimators</td>
<td>str</td>
<td>A list of the available CATE estimators out of the box. Validity of estimator at runtime will depend on the outcome and treatment types and be automatically selected.</td>
</tr>
<tr class="odd">
<td>model_Y_X_W</td>
<td>sklearn.base.BaseEstimator</td>
<td>The fitted nuisance function for the outcome variable.</td>
</tr>
<tr class="even">
<td>model_Y_X_W_T</td>
<td>sklearn.base.BaseEstimator</td>
<td>The fitted nuisance function for the outcome variable with treatment variable.</td>
</tr>
<tr class="odd">
<td>model_T_X_W</td>
<td>sklearn.base.BaseEstimator</td>
<td>The fitted nuisance function for the treatment variable.</td>
</tr>
<tr class="even">
<td>cate_estimators</td>
<td>dict[str, econml._cate_estimator.BaseCateEstimator | econml.score.EnsembleCateEstimator]</td>
<td>Dictionary of fitted cate estimator objects.</td>
</tr>
<tr class="odd">
<td>rscores</td>
<td>dict[str, float]</td>
<td>Dictionary of RScore values for each fitted cate estimator.</td>
</tr>
<tr class="even">
<td>validation_estimator</td>
<td>econml._cate_estimator.BaseCateEstimator | econml.score.EnsembleCateEstimator</td>
<td>The fitted EconML estimator object for validation.</td>
</tr>
<tr class="odd">
<td>validator_results</td>
<td>econml.validate.results.EvaluationResults</td>
<td>The validation results object.</td>
</tr>
<tr class="even">
<td>final_estimator</td>
<td>econml._cate_estimator.BaseCateEstimator | econml.score.EnsembleCateEstimator</td>
<td>The fitted EconML estimator object on the entire dataset after validation.</td>
</tr>
<tr class="odd">
<td>input_names</td>
<td>dict[str, list[str]]</td>
<td>The feature, outcome, and treatment names used in the CATE estimators.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples" class="level2 doc-section doc-section-examples">
<h2 class="doc-section doc-section-examples anchored" data-anchor-id="examples">Examples</h2>
<div id="460c8d63" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> caml <span class="im">import</span> CamlCATE</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> caml.extensions.synthetic_data <span class="im">import</span> SyntheticDataGenerator</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>data_generator <span class="op">=</span> SyntheticDataGenerator(seed<span class="op">=</span><span class="dv">10</span>, n_cont_modifiers<span class="op">=</span><span class="dv">1</span>, n_cont_confounders<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> data_generator.df</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>caml_obj <span class="op">=</span> CamlCATE(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    Y<span class="op">=</span><span class="st">"Y1_continuous"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    T<span class="op">=</span><span class="st">"T1_binary"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    X<span class="op">=</span>[c <span class="cf">for</span> c <span class="kw">in</span> df.columns <span class="cf">if</span> <span class="st">"X"</span> <span class="kw">in</span> c <span class="kw">or</span> <span class="st">"W"</span> <span class="kw">in</span> c],</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    discrete_treatment<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    discrete_outcome<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(caml_obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>================== CamlCATE Object ==================
Data Backend: pandas
No. of Observations: 10,000
Outcome Variable: Y1_continuous
Discrete Outcome: False
Treatment Variable: T1_binary
Discrete Treatment: True
Features/Confounders for Heterogeneity (X): ['W1_continuous', 'X1_continuous']
Features/Confounders as Controls (W): []
Random Seed: 0
</code></pre>
</div>
</div>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#caml.CamlCATE.auto_nuisance_functions">auto_nuisance_functions</a></td>
<td>Leverages AutoML to find optimal nuisance functions/regression &amp; propensity models for use in EconML CATE estimators.</td>
</tr>
<tr class="even">
<td><a href="#caml.CamlCATE.fit_validator">fit_validator</a></td>
<td>Fits the CATE models on the training set and evaluates them &amp; ensembles based on the validation set.</td>
</tr>
<tr class="odd">
<td><a href="#caml.CamlCATE.validate">validate</a></td>
<td>Validates the fitted CATE models on the test set to check for generalization performance.</td>
</tr>
<tr class="even">
<td><a href="#caml.CamlCATE.fit_final">fit_final</a></td>
<td>Fits the final estimator on the entire dataset, after validation and testing.</td>
</tr>
<tr class="odd">
<td><a href="#caml.CamlCATE.predict">predict</a></td>
<td>Predicts the CATE based on the fitted final estimator for either the internal dataset or provided Data.</td>
</tr>
<tr class="even">
<td><a href="#caml.CamlCATE.summarize">summarize</a></td>
<td>Provides population summary statistics for the CATE predictions for either the internal results or provided results.</td>
</tr>
</tbody>
</table>
<section id="caml.CamlCATE.auto_nuisance_functions" class="level3">
<h3 class="anchored" data-anchor-id="caml.CamlCATE.auto_nuisance_functions">auto_nuisance_functions</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>CamlCATE.auto_nuisance_functions(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    flaml_Y_kwargs<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    flaml_T_kwargs<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    use_ray<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    use_spark<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Leverages AutoML to find optimal nuisance functions/regression &amp; propensity models for use in EconML CATE estimators.</p>
<p>Sets the <code>model_Y_X_W</code>, <code>model_Y_X_W_T</code>, and <code>model_T_X_W</code> attributes to the fitted nuisance functions.</p>
<section id="parameters-1" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-1">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 75%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flaml_Y_kwargs</td>
<td>dict | None</td>
<td>The keyword arguments for the FLAML AutoML search for the outcome model. Default implies the base parameters in CamlBase.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>flaml_T_kwargs</td>
<td>dict | None</td>
<td>The keyword arguments for the FLAML AutoML search for the treatment model. Default implies the base parameters in CamlBase.</td>
<td><code>None</code></td>
</tr>
<tr class="odd">
<td>use_ray</td>
<td>bool</td>
<td>A boolean indicating whether to use Ray for parallel processing.</td>
<td><code>False</code></td>
</tr>
<tr class="even">
<td>use_spark</td>
<td>bool</td>
<td>A boolean indicating whether to use Spark for parallel processing.</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-1" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-1">Examples</h4>
<div id="4ffc4498" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>flaml_Y_kwargs <span class="op">=</span> {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"n_jobs"</span>: <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time_budget"</span>: <span class="dv">10</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"verbose"</span>: <span class="dv">0</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>flaml_T_kwargs <span class="op">=</span> {</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"n_jobs"</span>: <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"time_budget"</span>: <span class="dv">10</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"verbose"</span>: <span class="dv">0</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>caml_obj.auto_nuisance_functions(</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    flaml_Y_kwargs<span class="op">=</span>flaml_Y_kwargs,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    flaml_T_kwargs<span class="op">=</span>flaml_T_kwargs,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    use_ray<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    use_spark<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(caml_obj.model_Y_X_W)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(caml_obj.model_Y_X_W_T)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(caml_obj.model_T_X_W)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ExtraTreesRegressor(max_leaf_nodes=18, n_estimators=24, n_jobs=-1,
                    random_state=12032022)
LGBMRegressor(learning_rate=0.2017120542846939, max_bin=1023,
              min_child_samples=7, n_estimators=18, n_jobs=-1, num_leaves=4,
              reg_alpha=0.002624235729227695, reg_lambda=0.43771075793802855,
              verbose=-1)
ExtraTreesClassifier(criterion='entropy', max_features=0.6334496470801398,
                     max_leaf_nodes=5, n_estimators=12, n_jobs=-1,
                     random_state=12032022)</code></pre>
</div>
</div>
</section>
</section>
<section id="caml.CamlCATE.fit_validator" class="level3">
<h3 class="anchored" data-anchor-id="caml.CamlCATE.fit_validator">fit_validator</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>CamlCATE.fit_validator(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    cate_estimators<span class="op">=</span>[<span class="st">'LinearDML'</span>, <span class="st">'CausalForestDML'</span>, <span class="st">'NonParamDML'</span>, <span class="st">'SparseLinearDML-2D'</span>, <span class="st">'DRLearner'</span>, <span class="st">'ForestDRLearner'</span>, <span class="st">'LinearDRLearner'</span>, <span class="st">'DomainAdaptationLearner'</span>, <span class="st">'SLearner'</span>, <span class="st">'TLearner'</span>, <span class="st">'XLearner'</span>],</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    additional_cate_estimators<span class="op">=</span>[],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    ensemble<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    rscorer_kwargs<span class="op">=</span>{},</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    use_ray<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    ray_remote_func_options_kwargs<span class="op">=</span>{},</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    validation_size<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    sample_size<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Fits the CATE models on the training set and evaluates them &amp; ensembles based on the validation set.</p>
<p>Sets the <code>validation_estimator</code> attribute to the best fitted EconML estimator and <code>cate_estimators</code> attribute to all the fitted CATE models.</p>
<section id="parameters-2" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-2">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 32%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cate_estimators</td>
<td>Iterable[str]</td>
<td>The list of CATE estimators to fit and ensemble. Default implies all available models as defined by class.</td>
<td><code>['LinearDML', 'CausalForestDML', 'NonParamDML', 'SparseLinearDML-2D', 'DRLearner', 'ForestDRLearner', 'LinearDRLearner', 'DomainAdaptationLearner', 'SLearner', 'TLearner', 'XLearner']</code></td>
</tr>
<tr class="even">
<td>additional_cate_estimators</td>
<td>list[tuple[str, BaseCateEstimator]]</td>
<td>The list of additional CATE estimators to fit and ensemble</td>
<td><code>[]</code></td>
</tr>
<tr class="odd">
<td>ensemble</td>
<td>bool</td>
<td>The boolean indicating whether to ensemble the CATE models &amp; score.</td>
<td><code>False</code></td>
</tr>
<tr class="even">
<td>rscorer_kwargs</td>
<td>dict</td>
<td>The keyword arguments for the econml.score.RScorer object.</td>
<td><code>{}</code></td>
</tr>
<tr class="odd">
<td>use_ray</td>
<td>bool</td>
<td>A boolean indicating whether to use Ray for parallel processing.</td>
<td><code>False</code></td>
</tr>
<tr class="even">
<td>ray_remote_func_options_kwargs</td>
<td>dict</td>
<td>The keyword arguments for the Ray remote function options.</td>
<td><code>{}</code></td>
</tr>
<tr class="odd">
<td>validation_size</td>
<td>float</td>
<td>The fraction of the dataset to use for model scoring via RScorer.</td>
<td><code>0.2</code></td>
</tr>
<tr class="even">
<td>test_size</td>
<td>float</td>
<td>The fraction of the dataset to hold out for final evaluation in the <code>validate()</code> method.</td>
<td><code>0.2</code></td>
</tr>
<tr class="odd">
<td>sample_size</td>
<td>float</td>
<td>The fraction of the datasets to use. Useful for quick testing when dataframe is large. Defaults implies full training data.</td>
<td><code>1.0</code></td>
</tr>
<tr class="even">
<td>n_jobs</td>
<td>int</td>
<td>The number of parallel jobs to run.</td>
<td><code>-1</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-2" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-2">Examples</h4>
<div id="ac64a1e0" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> econml.dr <span class="im">import</span> LinearDRLearner</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>rscorer_kwargs <span class="op">=</span> {</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cv"</span>: <span class="dv">3</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mc_iters"</span>: <span class="dv">3</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>cate_estimators <span class="op">=</span> [<span class="st">"LinearDML"</span>, <span class="st">"NonParamDML"</span>, <span class="st">"CausalForestDML"</span>]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>additional_cate_estimators <span class="op">=</span> [</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"LinearDRLearner"</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        LinearDRLearner(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            model_propensity<span class="op">=</span>caml_obj.model_T_X_W,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            model_regression<span class="op">=</span>caml_obj.model_Y_X_W_T,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>            discrete_outcome<span class="op">=</span>caml_obj.discrete_outcome,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            cv<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>            random_state<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>caml_obj.fit_validator(</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    cate_estimators<span class="op">=</span>cate_estimators,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    additional_cate_estimators<span class="op">=</span>additional_cate_estimators,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    rscorer_kwargs<span class="op">=</span>rscorer_kwargs,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    validation_size<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(caml_obj.validation_estimator)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(caml_obj.cate_estimators)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;econml.dr._drlearner.LinearDRLearner object at 0x7d0fa0b14c10&gt;
[('LinearDML', &lt;econml.dml.dml.LinearDML object at 0x7d0fa0b08220&gt;), ('NonParamDML', &lt;econml.dml.dml.NonParamDML object at 0x7d0fa0b15d80&gt;), ('CausalForestDML', &lt;econml.dml.causal_forest.CausalForestDML object at 0x7d0fa0b17400&gt;), ('LinearDRLearner', &lt;econml.dr._drlearner.LinearDRLearner object at 0x7d0fa0b14c10&gt;)]</code></pre>
</div>
</div>
</section>
</section>
<section id="caml.CamlCATE.validate" class="level3">
<h3 class="anchored" data-anchor-id="caml.CamlCATE.validate">validate</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>CamlCATE.validate(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    n_groups<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    n_bootstrap<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    estimator<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    print_full_report<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Validates the fitted CATE models on the test set to check for generalization performance.</p>
<p>Uses the DRTester class from EconML to obtain the Best Linear Predictor (BLP), Calibration, AUTOC, and QINI. See <a href="https://econml.azurewebsites.net/_autosummary/econml.validate.DRTester.html">EconML documentation</a> for more details. In short, we are checking for the ability of the model to find statistically significant heterogeneity in a “well-calibrated” fashion.</p>
<p>Sets the <code>validator_report</code> attribute to the validation report.</p>
<section id="parameters-3" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-3">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 30%">
<col style="width: 51%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n_groups</td>
<td>int</td>
<td>The number of quantile based groups used to calculate calibration scores.</td>
<td><code>4</code></td>
</tr>
<tr class="even">
<td>n_bootstrap</td>
<td>int</td>
<td>The number of boostrap samples to run when calculating confidence bands.</td>
<td><code>100</code></td>
</tr>
<tr class="odd">
<td>estimator</td>
<td>BaseCateEstimator | EnsembleCateEstimator | None</td>
<td>The estimator to validate. Default implies the best estimator from the validation set.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>print_full_report</td>
<td>bool</td>
<td>A boolean indicating whether to print the full validation report.</td>
<td><code>True</code></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-3" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-3">Examples</h4>
<div id="62ed407d" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>caml_obj.validate()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>caml_obj.validator_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   treatment  blp_est  blp_se  blp_pval  qini_est  qini_se  qini_pval  autoc_est  autoc_se  autoc_pval  cal_r_squared
0          1    1.009   0.007       0.0     2.063    0.063        0.0        6.0      0.23         0.0          0.992</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="CamlCATE_files/figure-html/cell-5-output-2.png" width="616" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="CamlCATE_files/figure-html/cell-5-output-3.png" width="591" height="454" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="CamlCATE_files/figure-html/cell-5-output-4.png" width="587" height="454" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="caml.CamlCATE.fit_final" class="level3">
<h3 class="anchored" data-anchor-id="caml.CamlCATE.fit_final">fit_final</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>CamlCATE.fit_final()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Fits the final estimator on the entire dataset, after validation and testing.</p>
<p>Sets the <code>input_names</code> and <code>final_estimator</code> class attributes.</p>
<section id="examples-4" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-4">Examples</h4>
<div id="f6d710f0" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>caml_obj.fit_final()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(caml_obj.final_estimator)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(caml_obj.input_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;econml.dr._drlearner.LinearDRLearner object at 0x7d0fe19aa8c0&gt;
{'feature_names': ['W1_continuous', 'X1_continuous'], 'output_names': 'Y1_continuous', 'treatment_names': 'T1_binary'}</code></pre>
</div>
</div>
</section>
</section>
<section id="caml.CamlCATE.predict" class="level3">
<h3 class="anchored" data-anchor-id="caml.CamlCATE.predict">predict</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>CamlCATE.predict(X<span class="op">=</span><span class="va">None</span>, T0<span class="op">=</span><span class="dv">0</span>, T1<span class="op">=</span><span class="dv">1</span>, T<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Predicts the CATE based on the fitted final estimator for either the internal dataset or provided Data.</p>
<p>For binary treatments, the CATE is the estimated effect of the treatment and for a continuous treatment, the CATE is the estimated effect of a one-unit increase in the treatment. This can be modified by setting the T0 and T1 parameters to the desired treatment levels.</p>
<section id="parameters-4" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-4">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 20%">
<col style="width: 69%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X</td>
<td>pandas.DataFrame | np.ndarray | None</td>
<td>The DataFrame containing the features (X) for which CATE needs to be predicted. If not provided, defaults to the internal dataset.</td>
<td><code>None</code></td>
</tr>
<tr class="even">
<td>T0</td>
<td>int</td>
<td>Base treatment for each sample.</td>
<td><code>0</code></td>
</tr>
<tr class="odd">
<td>T1</td>
<td>int</td>
<td>Target treatment for each sample.</td>
<td><code>1</code></td>
</tr>
<tr class="even">
<td>T</td>
<td>pandas.DataFrame | np.ndarray | None</td>
<td>Treatment vector if continuous treatment is leveraged for computing marginal effects around treatments for each individual.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 14%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>np.ndarray</td>
<td>The predicted CATE values if return_predictions is set to True.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-5" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-5">Examples</h4>
<div id="c02af1f0" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>caml_obj.predict()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>array([ 11.55615161,  -9.12879923, -32.23373441, ...,  -4.76383905,
        -4.70925096, -24.61283042])</code></pre>
</div>
</div>
</section>
</section>
<section id="caml.CamlCATE.summarize" class="level3">
<h3 class="anchored" data-anchor-id="caml.CamlCATE.summarize">summarize</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>CamlCATE.summarize(cate_predictions<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Provides population summary statistics for the CATE predictions for either the internal results or provided results.</p>
<section id="parameters-5" class="level4 doc-section doc-section-parameters">
<h4 class="doc-section doc-section-parameters anchored" data-anchor-id="parameters-5">Parameters</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 77%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cate_predictions</td>
<td>np.ndarray | None</td>
<td>The CATE predictions for which summary statistics will be generated. If not provided, defaults to internal CATE predictions generated by <code>predict()</code> method with X=None.</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</section>
<section id="returns-1" class="level4 doc-section doc-section-returns">
<h4 class="doc-section doc-section-returns anchored" data-anchor-id="returns-1">Returns</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 37%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>pandas.DataFrame | pandas.Series</td>
<td>The summary statistics for the CATE predictions.</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-6" class="level4 doc-section doc-section-examples">
<h4 class="doc-section doc-section-examples anchored" data-anchor-id="examples-6">Examples</h4>
<div id="73f00df6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>caml_obj.summarize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">cate_predictions_0_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>10000.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>-7.678999</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>8.300624</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-54.891400</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>-11.696471</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>-7.767693</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>-3.646849</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>47.230626</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>
</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Jacob Pieniazek</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jakepenzak/caml/edit/main/docs/04_Reference/CamlCATE.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jakepenzak/caml/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Powered by: <a href="https://quarto.org/"><img src="../assets/external_logos/quarto.png" class="img-fluid" width="85"></a></p>
</div>
  </div>
</footer>




</body></html>