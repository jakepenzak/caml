{
  "version": "1",
  "metadata": {
    "marimo_version": "0.11.17"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "MJUe",
      "code_hash": "6ebd477e369b2e5178b09b3beee8b6dc",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"fastleastsquares-api-usage\">FastLeastSquares API Usage</h1></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "d4980e67bd37467603cb28bf64628ee0",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:35:02] DEBUG    Logging configured with level: DEBUG                                                                                                                                     logging.py:70\n"
        }
      ]
    },
    {
      "id": "bkHC",
      "code_hash": "0cfd3aedf30835e9e3c7f0cfd07562ee",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "bc0622d6955ac69eb2db2a89ae7530d9",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "PKri",
      "code_hash": "8f518858839139bd50e9c19ec4c5b9ef",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:35:15] DEBUG    Initializing FastLeastSquares with parameters: Y=['Y1_continuous'], T=T1_binary, G=['X3_discrete', 'X4_discrete'], X=['X1_continuous', 'X2_continuous'],           leastsquares.py:109\n                             W=['W1_continuous', 'W2_continuous'], discrete_treatment=True, engine=cpu                                                                                                             \n                    DEBUG    Created formula: Y1_continuous ~ T1_binary + C(X3_discrete)*T1_binary + C(X4_discrete)*T1_binary + X1_continuous*T1_binary + X2_continuous*T1_binary +             leastsquares.py:137\n                             W1_continuous + W2_continuous                                                                                                                                                         \n"
        }
      ]
    },
    {
      "id": "Xref",
      "code_hash": "fb7c312847c8474df90d20fc197f6551",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:35:16] DEBUG    Creating model matrix...                                                                                                                                           leastsquares.py:354\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Design Matrix Creation completed in 0.21 seconds                                                                                                                       _generics.py:83\n                    INFO     Fitting regression model...                                                                                                                                        leastsquares.py:231\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:35:17] DEBUG    Model Fitting completed in 0.66 seconds                                                                                                                                _generics.py:83\n                    DEBUG    Creating treatment difference matrix...                                                                                                                            leastsquares.py:328\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Design Matrix Creation completed in 0.35 seconds                                                                                                                       _generics.py:83\n                    INFO     Estimating Average Treatment Effects (ATEs)...                                                                                                                     leastsquares.py:255\n                    DEBUG    ATE Estimation completed in 0.01 seconds                                                                                                                               _generics.py:83\n                    INFO     Estimating Group Average Treatment Effects (GATEs)...                                                                                                              leastsquares.py:283\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Starting parallel processing with -1 jobs                                                                                                                          leastsquares.py:311\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:35:18] DEBUG    GATE Estimation completed in 0.14 seconds                                                                                                                              _generics.py:83\n"
        }
      ]
    },
    {
      "id": "SFPL",
      "code_hash": "7f6a792d8af863d4bbc2147c292c9e6f",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='SFPL-0' random-id='64c19903-cfde-7d41-6f76-ee4bd53c070e'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/1165-9701-RccSk0mg.csv&quot;' data-total-rows='11' data-total-columns='10' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;group&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;membership&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;outcome&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;ate&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;std_err&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;t_stat&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;pval&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;n&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;n_treated&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;n_control&quot;, [&quot;integer&quot;, &quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "BYtC",
      "code_hash": "5f57ddd092b92e8c220035a3b96a4cf9",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:13:18] INFO     Converting data to design          fastlstsq.py:146\n                             matrix...                                          \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:13:45] DEBUG    Design matrix conversion completed fastlstsq.py:150\n                             in 27.51 seconds                                   \n                    DEBUG    Moving data to cpu                 fastlstsq.py:152\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Data shape - X: (5000000, 78), y:  fastlstsq.py:157\n                             (5000000, 3)                                       \n                    DEBUG    Data transfer completed in 0.19    fastlstsq.py:162\n                             seconds                                            \n                    INFO     Fitting regression model...        fastlstsq.py:164\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Model fitting completed in 0.07    fastlstsq.py:189\n                             seconds                                            \n                    DEBUG    Creating treatment difference      fastlstsq.py:301\n                             matrix                                             \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:14:51] DEBUG    Difference matrix created in 66.02 fastlstsq.py:320\n                             seconds. Shape: (5000000, 78)                      \n                    INFO     Estimating Average Treatment       fastlstsq.py:201\n                             Effects (ATEs)...                                  \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:14:52] DEBUG    ATE estimation completed in 0.39   fastlstsq.py:220\n                             seconds                                            \n                    INFO     Estimating Group Average Treatment fastlstsq.py:242\n                             Effects (GATEs)...                                 \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:14:57] DEBUG    Starting parallel processing with  fastlstsq.py:285\n                             20 jobs                                            \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:15:03] DEBUG    GATE estimation completed in 11.50 fastlstsq.py:298\n                             seconds                                            \n"
        }
      ]
    },
    {
      "id": "LfQb",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "RGSE",
      "code_hash": "92ac5144669cc71b3f80376cc25c1406",
      "outputs": [],
      "console": []
    },
    {
      "id": "lzxb",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>&#x27;Y1 + Y2 + Y3 ~ T + C(G1)*T + C(G2)*T + C(G3)*T + C(G4)*T + C(G5)*T + C(G6)*T + C(G7)*T + C(G8)*T + X1*T + X2*T + X3*T + W1 + W2 + W3 + W4 + W5 + W6&#x27;</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "qOee",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='qOee-0' random-id='6899ae02-c725-06ab-a847-0dae69b06bef'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/2789-2402077-Pv2gI0aO.csv&quot;' data-total-rows='19929' data-total-columns='23' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;Y1&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;Y2&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;Y3&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;T&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;G1&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G2&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G3&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G4&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G5&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G6&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G7&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G8&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;X1&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;X2&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;X3&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W1&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W2&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W3&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W4&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W5&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W6&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;product_group&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;modality&quot;, [&quot;string&quot;, &quot;object&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[&quot;&quot;]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "jRNZ",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "application/json": "{\"outcomes\": [\"Y1\", \"Y2\", \"Y3\"], \"ate\": \"text/plain:[ 0.00815418 -0.00655838  0.00183916]\", \"std_err\": \"text/plain:[0.00599444 0.00599272 0.00599915]\", \"t_stat\": \"text/plain:[ 1.3602902  -1.09439059  0.30656955]\", \"pval\": \"text/plain:[0.17373811 1.72621629 0.75917103]\", \"n\": 40011, \"n_treated\": 20065, \"n_control\": 19946}"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ZBrm",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/08/25 23:00:35] DEBUG    Logging configured with level: Level  logging.py:63\n                             1                                                  \n"
        }
      ]
    },
    {
      "id": "xwty",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "application/json": "[\"G\", \"T\", \"W\", \"X\", \"Y\", \"__class__\", \"__delattr__\", \"__dict__\", \"__dir__\", \"__doc__\", \"__eq__\", \"__format__\", \"__ge__\", \"__getattribute__\", \"__gt__\", \"__hash__\", \"__init__\", \"__init_subclass__\", \"__le__\", \"__lt__\", \"__module__\", \"__ne__\", \"__new__\", \"__reduce__\", \"__reduce_ex__\", \"__repr__\", \"__setattr__\", \"__sizeof__\", \"__str__\", \"__subclasshook__\", \"__weakref__\", \"_compute_statistics\", \"_create_diff_matrix\", \"_create_formula\", \"_estimate_ates\", \"_estimate_gates\", \"_fit\", \"_fitted\", \"convert_dataframe_to_pandas\", \"discrete_treatment\", \"engine\", \"estimate_cate\", \"fit\", \"formula\", \"results\"]"
          }
        }
      ],
      "console": []
    },
    {
      "id": "xxUI",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>True</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "SoYd",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "zwUb",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>&#x27;FastLSTSQ&#x27;</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "tERy",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "application/json": "{\"outcomes\": [\"Y1\", \"Y2\", \"Y3\"], \"ate\": \"text/plain:[ 0.00961466 -0.00682365  0.00342111]\", \"std_err\": \"text/plain:[0.0062056  0.00620381 0.00621047]\", \"t_stat\": \"text/plain:[ 1.54935223 -1.09991209  0.55086242]\", \"pval\": \"text/plain:[0.12129707 1.72862957 0.58172799]\", \"n\": 19929, \"n_treated\": 9954, \"n_control\": 9975}"
          }
        }
      ],
      "console": []
    },
    {
      "id": "pqBd",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>&#x27;\\n    FastLSTSQ is a fast implementation of the LSTSQ estimator.\\n    &#x27;</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "hnYx",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='hnYx-0' random-id='6899ae02-c725-06ab-a847-0dae69b06bef'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/2789-2598630-HJINSqiN.csv&quot;' data-total-rows='19929' data-total-columns='23' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;Y1&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;Y2&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;Y3&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;T&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;G1&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G2&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G3&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G4&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G5&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G6&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G7&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;G8&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;X1&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;X2&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;X3&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W1&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W2&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W3&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W4&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W5&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W6&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;product_group&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;modality&quot;, [&quot;string&quot;, &quot;object&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[&quot;&quot;]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "bzkw",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>920000000</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "gKkg",
      "code_hash": null,
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "This cell raised an exception: TypeCheckError('argument \"memory_per_job\" (float) is not an instance of int')",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/home/jadmin/projects/caml/.venv/lib/python3.10/site-packages/marimo/_runtime/executor.py&quot;</span>, line <span class=\"m\">141</span>, in <span class=\"n\">execute_cell</span>\n<span class=\"w\">    </span><span class=\"n\">exec</span><span class=\"p\">(</span><span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"n\">body</span><span class=\"p\">,</span> <span class=\"n\">glbls</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/tmp/marimo_2754742/__marimo__cell_gKkg_.py&quot;</span>, line <span class=\"m\">14</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">n_jobs</span> <span class=\"o\">=</span> <span class=\"n\">fu</span><span class=\"o\">.</span><span class=\"n\">_calculate_optimal_jobs</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/home/jadmin/projects/caml/caml/traditional/fastlstsq.py&quot;</span>, line <span class=\"m\">391</span>, in <span class=\"n\">_calculate_optimal_jobs</span>\n<span class=\"w\">    </span><span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">_calculate_optimal_jobs</span><span class=\"p\">(</span><span class=\"n\">memory_per_job</span><span class=\"p\">:</span> <span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"n\">total_memory_limit</span><span class=\"p\">:</span> <span class=\"nb\">float</span> <span class=\"o\">=</span> <span class=\"mf\">0.8</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">int</span><span class=\"p\">:</span>\n  File <span class=\"nb\">&quot;/home/jadmin/projects/caml/.venv/lib/python3.10/site-packages/typeguard/_functions.py&quot;</span>, line <span class=\"m\">137</span>, in <span class=\"n\">check_argument_types</span>\n<span class=\"w\">    </span><span class=\"n\">check_type_internal</span><span class=\"p\">(</span><span class=\"n\">value</span><span class=\"p\">,</span> <span class=\"n\">annotation</span><span class=\"p\">,</span> <span class=\"n\">memo</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/home/jadmin/projects/caml/.venv/lib/python3.10/site-packages/typeguard/_checkers.py&quot;</span>, line <span class=\"m\">956</span>, in <span class=\"n\">check_type_internal</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"n\">TypeCheckError</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s2\">&quot;is not an instance of </span><span class=\"si\">{</span><span class=\"n\">qualified_name</span><span class=\"p\">(</span><span class=\"n\">origin_type</span><span class=\"p\">)</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"gr\">typeguard.TypeCheckError</span>: <span class=\"n\">argument &quot;memory_per_job&quot; (float) is not an instance of int</span>\n</pre></div>\n</span>"
        }
      ]
    },
    {
      "id": "Kclp",
      "code_hash": "fb7c312847c8474df90d20fc197f6551",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:18:39] INFO     Converting data to design          fastlstsq.py:146\n                             matrix...                                          \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:19:05] DEBUG    Design matrix conversion completed fastlstsq.py:150\n                             in 26.88 seconds                                   \n                    DEBUG    Moving data to cpu                 fastlstsq.py:152\n                    DEBUG    Data shape - X: (5000000, 78), y:  fastlstsq.py:157\n                             (5000000, 3)                                       \n                    DEBUG    Data transfer completed in 0.00    fastlstsq.py:162\n                             seconds                                            \n                    INFO     Fitting regression model...        fastlstsq.py:164\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Model fitting completed in 0.05    fastlstsq.py:189\n                             seconds                                            \n                    DEBUG    Creating treatment difference      fastlstsq.py:301\n                             matrix                                             \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:20:10] DEBUG    Difference matrix created in 64.14 fastlstsq.py:320\n                             seconds. Shape: (5000000, 78)                      \n                    INFO     Estimating Average Treatment       fastlstsq.py:201\n                             Effects (ATEs)...                                  \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    ATE estimation completed in 0.02   fastlstsq.py:220\n                             seconds                                            \n                    INFO     Estimating Group Average Treatment fastlstsq.py:242\n                             Effects (GATEs)...                                 \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:20:14] DEBUG    Starting parallel processing with  fastlstsq.py:285\n                             -1 jobs                                            \n"
        }
      ]
    },
    {
      "id": "pwvN",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>2.0</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "tnrh",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>25413758976</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "emfo",
      "code_hash": "7f6a792d8af863d4bbc2147c292c9e6f",
      "outputs": [],
      "console": []
    },
    {
      "id": "Hstk",
      "code_hash": "0561c2f4a78f061bfc89ec4d5018007f",
      "outputs": [
        {
          "type": "data",
          "data": {
            "application/json": "{\"outcome\": [\"Y1_continuous\"], \"ate\": \"text/plain:[-2.9350309]\", \"std_err\": \"text/plain:[0.09743113]\", \"t_stat\": \"text/plain:[-30.12415832]\", \"pval\": \"text/plain:[0.]\", \"n\": 621, \"n_treated\": 40, \"n_control\": 581}"
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:35:22] DEBUG    Creating treatment difference matrix...                                                                                                                            leastsquares.py:328\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Design Matrix Creation completed in 0.17 seconds                                                                                                                       _generics.py:83\n                    INFO     Estimating single Conditional Average Treatment Effect (CATE)...                                                                                                   leastsquares.py:175\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Single CATE Estimation completed in 0.22 seconds                                                                                                                       _generics.py:83\n"
        }
      ]
    },
    {
      "id": "hMlt",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>27</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "rrus",
      "code_hash": null,
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "This cell raised an exception: AttributeError(''DataFrame' object has no attribute 'nbytes'')",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/home/jadmin/projects/caml/.venv/lib/python3.10/site-packages/marimo/_runtime/executor.py&quot;</span>, line <span class=\"m\">142</span>, in <span class=\"n\">execute_cell</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"nb\">eval</span><span class=\"p\">(</span><span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"n\">last_expr</span><span class=\"p\">,</span> <span class=\"n\">glbls</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/tmp/marimo_2839610/__marimo__cell_rrus_.py&quot;</span>, line <span class=\"m\">1</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">df</span><span class=\"o\">.</span><span class=\"n\">nbytes</span>\n  File <span class=\"nb\">&quot;/home/jadmin/projects/caml/.venv/lib/python3.10/site-packages/pandas/core/generic.py&quot;</span>, line <span class=\"m\">6299</span>, in <span class=\"n\">__getattr__</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"nb\">object</span><span class=\"o\">.</span><span class=\"fm\">__getattribute__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">)</span>\n<span class=\"gr\">AttributeError</span>: <span class=\"n\">&#39;DataFrame&#39; object has no attribute &#39;nbytes&#39;</span>\n</pre></div>\n</span>"
        }
      ]
    },
    {
      "id": "ckEc",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "application/json": "{\"outcomes\": [\"Y1\", \"Y2\", \"Y3\"], \"ate\": \"text/plain:[ 0.00293429 -0.00414922  0.02324453]\", \"std_err\": \"text/plain:[0.00951845 0.00951085 0.00952897]\", \"t_stat\": \"text/plain:[ 0.30827408 -0.43626132  2.43935464]\", \"pval\": \"text/plain:[0.75787378 1.33735286 0.01471352]\", \"n\": 3133, \"n_treated\": 1546, \"n_control\": 1587}"
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/09/25 00:53:08] DEBUG    Creating treatment difference      fastlstsq.py:279\n                             matrix                                             \n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Difference matrix created in 0.04  fastlstsq.py:298\n                             seconds. Shape: (3133, 78)                         \n                    INFO     Estimating single Conditional       fastlstsq.py:99\n                             Average Treatment Effect (CATE)...                 \n"
        }
      ]
    },
    {
      "id": "jQza",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='jQza-0' random-id='c218347d-f976-8b5f-782d-98434c4d33f9'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/400-8447-jLTBFSng.csv&quot;' data-total-rows='3' data-total-columns='10' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;group&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;membership&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;outcome&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;ate&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;std_err&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;t_stat&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;pval&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;n&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;n_treated&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;n_control&quot;, [&quot;integer&quot;, &quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ZUuT",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='ZUuT-0' random-id='9c41b51a-4e05-2058-af53-52302bbc999d'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/1118-8447-7h6gczTQ.csv&quot;' data-total-rows='123' data-total-columns='10' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;group&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;membership&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;outcome&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;ate&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;std_err&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;t_stat&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;pval&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;n&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;n_treated&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;n_control&quot;, [&quot;integer&quot;, &quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "YsWw",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "hBmc",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='hBmc-0' random-id='ca7112c6-2c61-1c2b-9fa0-c18e9bf598db'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/364-7576-YXFuwmbW.csv&quot;' data-total-rows='10000' data-total-columns='6' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;X1_discrete&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;X2_discrete&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;X3_discrete&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;X4_discrete&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;T1_binary&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;Y1_continuous&quot;, [&quot;number&quot;, &quot;float64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "oDTq",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='oDTq-0' random-id='13a71fd4-1722-0765-2691-0e49c565edbd'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/225-7576-pfdo2uiv.csv&quot;' data-total-rows='10000' data-total-columns='1' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;CATE_of_T1_binary_on_Y1_continuous&quot;, [&quot;number&quot;, &quot;float64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "qzgv",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>7.410965963143449</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "OOOL",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>7.410965963143447</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "SvaO",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>Index([&#x27;X1_discrete&#x27;, &#x27;X2_discrete&#x27;, &#x27;X3_discrete&#x27;, &#x27;X4_discrete&#x27;, &#x27;T1_binary&#x27;,\n       &#x27;Y1_continuous&#x27;, &#x27;cates&#x27;],\n      dtype=&#x27;object&#x27;)</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "xaZJ",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:02:59] DEBUG    Initializing FastLeastSquares with parameters: Y=['Y1_continuous'], T=T1_binary, G=['X1_discrete', 'X2_discrete', 'X3_discrete', 'X4_discrete'], X=None, W=None,   leastsquares.py:109\n                             discrete_treatment=True, engine=cpu                                                                                                                                                   \n                    DEBUG    Created formula: Y1_continuous ~ T1_binary + C(X1_discrete)*T1_binary + C(X2_discrete)*T1_binary + C(X3_discrete)*T1_binary + C(X4_discrete)*T1_binary             leastsquares.py:137\n"
        }
      ]
    },
    {
      "id": "UFlm",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:03:01] DEBUG    Creating model matrix...                                                                                                                                           leastsquares.py:354\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Design Matrix Creation completed in 0.23 seconds                                                                                                                       _generics.py:83\n                    INFO     Fitting regression model...                                                                                                                                        leastsquares.py:231\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:03:02] DEBUG    Model Fitting completed in 0.50 seconds                                                                                                                                _generics.py:83\n                    DEBUG    Creating treatment difference matrix...                                                                                                                            leastsquares.py:328\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:03:03] DEBUG    Design Matrix Creation completed in 0.62 seconds                                                                                                                       _generics.py:83\n                    INFO     Estimating Average Treatment Effects (ATEs)...                                                                                                                     leastsquares.py:255\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    ATE Estimation completed in 0.03 seconds                                                                                                                               _generics.py:83\n                    INFO     Estimating Group Average Treatment Effects (GATEs)...                                                                                                              leastsquares.py:283\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Starting parallel processing with -1 jobs                                                                                                                          leastsquares.py:311\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    GATE Estimation completed in 0.62 seconds                                                                                                                              _generics.py:83\n"
        }
      ]
    },
    {
      "id": "Nnfl",
      "code_hash": null,
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='Nnfl-0' random-id='5a0bbd1b-09c6-3b1a-8636-0d2c6b6d8e10'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/1238-7576-f9lerI8m.csv&quot;' data-total-rows='29' data-total-columns='10' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;group&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;membership&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;outcome&quot;, [&quot;string&quot;, &quot;object&quot;]], [&quot;ate&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;std_err&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;t_stat&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;pval&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;n&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;n_treated&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;n_control&quot;, [&quot;integer&quot;, &quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "nWHF",
      "code_hash": "7d620a586511c3f38a8774478379cccd",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>-3.0184009083674845</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "zMXV",
      "code_hash": "0d8d07ddb094f82646c2d62707f348bf",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>Index([&#x27;W1_continuous&#x27;, &#x27;W2_continuous&#x27;, &#x27;X1_continuous&#x27;, &#x27;X2_continuous&#x27;,\n       &#x27;X3_discrete&#x27;, &#x27;X4_discrete&#x27;, &#x27;T1_binary&#x27;, &#x27;Y1_continuous&#x27;, &#x27;cates&#x27;],\n      dtype=&#x27;object&#x27;)</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "BlwD",
      "code_hash": "09b78cbf83355d97c6f09e87237c5632",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='BlwD-0' random-id='18e5076f-1726-77fe-6480-9057425c5bbb'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/373-9701-Hi9rHoyT.csv&quot;' data-total-rows='10000' data-total-columns='2' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;CATE_of_T1_binary_on_Y1_continuous&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;CATE_of_T1_binary_on_Y2_binary&quot;, [&quot;number&quot;, &quot;float64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "UxMu",
      "code_hash": "6819f07beb51c1f8d367f25c1f73591c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "ATE for X3_discrete, 1: 0.6335493141475005\nATE for X3_discrete, 4: -0.8510849779649592\nATE for X3_discrete, 2: 0.261346351696702\nATE for X3_discrete, 0: 1.2301046980700172\nATE for X3_discrete, 5: -1.5432128797668943\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "ATE for X3_discrete, 3: -0.4031554776607481\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "ATE for X4_discrete, 0: 3.241581248610655\nATE for X4_discrete, 3: -3.654533945088993\nATE for X4_discrete, 2: -1.382510359717743\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "ATE for X4_discrete, 1: 0.817642467563613\n"
        }
      ]
    },
    {
      "id": "pLTo",
      "code_hash": "eff7d5dba32b4da32d9a67a519434d3f",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<marimo-ui-element object-id='pLTo-0' random-id='414ad860-5fcd-d816-9a22-4e44899849c2'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;./@file/1324-9701-rh25hPjs.csv&quot;' data-total-rows='10000' data-total-columns='9' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;W1_continuous&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;W2_continuous&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;X1_continuous&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;X2_continuous&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;X3_discrete&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;X4_discrete&quot;, [&quot;string&quot;, &quot;category&quot;]], [&quot;T1_binary&quot;, [&quot;integer&quot;, &quot;int64&quot;]], [&quot;Y1_continuous&quot;, [&quot;number&quot;, &quot;float64&quot;]], [&quot;cates&quot;, [&quot;number&quot;, &quot;float64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-row-headers='[]' data-has-stable-row-id='false'></marimo-table></marimo-ui-element>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "nDdp",
      "code_hash": "b282b0658cc66792a92f4632df51c510",
      "outputs": [
        {
          "type": "data",
          "data": {
            "application/json": "{\"outcome\": [\"Y1_continuous\"], \"ate\": \"text/plain:[-1.93518885]\", \"std_err\": \"text/plain:[0.091982]\", \"t_stat\": \"text/plain:[-21.03877775]\", \"pval\": \"text/plain:[0.]\", \"n\": 1174, \"n_treated\": 73, \"n_control\": 1101}"
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "[03/26/25 20:35:52] DEBUG    Creating treatment difference matrix...                                                                                                                            leastsquares.py:328\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Design Matrix Creation completed in 0.51 seconds                                                                                                                       _generics.py:83\n                    INFO     Estimating single Conditional Average Treatment Effect (CATE)...                                                                                                   leastsquares.py:175\n"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "                    DEBUG    Single CATE Estimation completed in 0.68 seconds                                                                                                                       _generics.py:83\n"
        }
      ]
    },
    {
      "id": "WeoZ",
      "code_hash": "8f986d249de8e9742509af2667b08e71",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/html": "<pre style='font-size: 12px'>-2.0278758666085492</pre>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "PNUn",
      "code_hash": "1f373d6d33c2c456fe328882940b583a",
      "outputs": [
        {
          "type": "data",
          "data": {
            "application/json": "[1, 4, 2, 0, 5, 3]"
          }
        }
      ],
      "console": []
    }
  ]
}
